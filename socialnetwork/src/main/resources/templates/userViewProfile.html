<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title th:text="${userProfile.user.firstName + ' ' + userProfile.user.lastName + ' - ISEP Connect'}">Profil</title>
	<link rel="stylesheet" th:href="@{/css/charteGraphique.css}">
	<link rel="stylesheet" th:href="@{/css/header.css}">
	<link rel="stylesheet" th:href="@{/css/profil.css}">
	<script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="bg-dark">

<div th:replace="~{fragments/header :: header-fragment}"></div>

<main class="profil-layout">
	<aside class="sidebar-left">
		<div class="card profile-card">
			<div class="avatar-section">
				<div class="avatar-wrapper">
					<img th:src="@{${userProfile.user.profilePictureUrl != null ? userProfile.user.profilePictureUrl : '/images/default-avatar.png'}}" alt="Avatar">
				</div>
			</div>

			<h2 class="user-fullname" th:text="${userProfile.user.firstName + ' ' + userProfile.user.lastName}">Alexandre Dupont</h2>
			<p class="user-studies" th:text="${userProfile.profile.profession}">Étudiant Ingénieur - ISEP</p>

			<div class="location-tag" th:if="${userProfile.privacySettings.canSeeLocation}">
				<i data-lucide="map-pin"></i>
				<span th:text="${userProfile.profile.location}">Paris, France</span>
			</div>

			<div class="stats-row">
				<div class="stat-box">
					<span class="label">PROMO</span>
					<span class="value text-primary" th:text="${userProfile.profile.promoYear}">2024</span>
				</div>
				<div class="stat-box">
					<span class="label">FILIÈRE</span>
					<span class="value text-primary" th:text="${userProfile.profile.isepSpecialization}">Logiciel</span>
				</div>
			</div>

			<div style="display: flex; flex-direction: column; gap: 10px;">
				<button id="followBtn"
						class="btn-primary-full"
						th:classappend="${isFollow ? 'unfollow' : 'follow'}"
						th:data-id="${userProfile.user.id}"
						th:text="${isFollow ? 'Ne plus suivre' : 'Suivre'}">
					Suivre
				</button>

				<a th:if="${userProfile.privacySettings.allowDirectMessages == 'true'}"
				   th:href="@{/messages(target=${userProfile.user.id})}"
				   class="btn-primary-full"
				   style="background: rgba(255,255,255,0.1); border: 1px solid var(--border);">
					Envoyer un message
				</a>
			</div>
		</div>

		<div class="card networks-card">
			<h3 class="sidebar-title">Réseaux</h3>
			<div class="network-links">
				<a th:if="${userProfile.profile.website}" th:href="${userProfile.profile.website}" target="_blank" class="network-item">
					<div class="item-left"><i data-lucide="globe"></i> <span>Portfolio</span></div>
					<i data-lucide="external-link" class="arrow-right"></i>
				</a>
				<div class="network-item" th:if="${userProfile.privacySettings.canSeeEmail}">
					<div class="item-left"><i data-lucide="mail"></i> <span th:text="${userProfile.user.email}">Email</span></div>
				</div>
			</div>
		</div>
	</aside>

	<section class="main-content">
		<div class="section-container">
			<div class="section-header">
				<h3><i data-lucide="user" class="icon-blue"></i> À propos</h3>
			</div>
			<div class="card box-content">
				<p th:text="${userProfile.user.bio != null ? userProfile.user.bio : 'Cet utilisateur n a pas encore rédigé de bio.'}">Bio...</p>
			</div>
		</div>

		<div class="section-container">
			<div class="section-header">
				<h3><i data-lucide="graduation-cap" class="icon-blue"></i> Formation</h3>
			</div>
			<div class="card box-content">
				<div class="tags-container">
					<span class="tag" th:text="${userProfile.profile.education}">Niveau d'étude</span>
					<span class="tag" th:text="${userProfile.profile.isepSpecialization}">Spécialisation</span>
					<span class="tag" th:text="'Promo ' + ${userProfile.profile.promoYear}">Promo</span>
				</div>
			</div>
		</div>

		<div class="section-container">
			<div class="section-header">
				<h3><i data-lucide="briefcase" class="icon-blue"></i> Expérience Professionnelle</h3>
			</div>
			<div class="projects-grid">
				<div class="card project-item" style="display: flex; align-items: center; padding: 20px; gap: 20px;">
					<div class="plus-circle"><i data-lucide="briefcase"></i></div>
					<div class="project-info" style="padding: 0;">
						<h4 th:text="${userProfile.profile.profession != null ? userProfile.profile.profession : 'En recherche d opportunités'}">Poste</h4>
						<p th:text="${userProfile.profile.company != null ? userProfile.profile.company : 'ISEP'}">Entreprise</p>
					</div>
				</div>
			</div>
		</div>

		<div class="section-container" th:if="${userProfile.privacySettings.canSeeBirthdate}">
			<div class="section-header">
				<h3><i data-lucide="calendar" class="icon-blue"></i> Informations</h3>
			</div>
			<div class="card box-content">
				<p><strong>Date de naissance :</strong> <span th:text="${userProfile.profile.birthdate}">01/01/2000</span></p>
				<p th:if="${userProfile.privacySettings.canSeePhone}"><strong>Téléphone :</strong> <span th:text="${userProfile.profile.phoneNumber}">Non renseigné</span></p>
			</div>
		</div>
	</section>
</main>

<div th:replace="~{fragments/footer :: footer-fragment}"></div>

<script th:src="@{/js/header.js}"></script>
<script th:src="@{/js/userViewProfile.js}"></script>
<script>lucide.createIcons();</script>
</body>
</html>