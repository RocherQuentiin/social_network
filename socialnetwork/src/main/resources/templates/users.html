<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Annuaire - ISEP Connect</title>
        <link rel="stylesheet" th:href="@{/css/charteGraphique.css}">
        <link rel="stylesheet" th:href="@{/css/header.css}">
        <link rel="stylesheet" th:href="@{/css/directory.css}">
        <link rel="stylesheet" th:href="@{/css/friendRequest.css}">
        <script src="https://unpkg.com/lucide@latest"></script>
    </head>
    <body class="bg-dark">

        <div th:replace="~{fragments/header :: header-fragment}"></div>

        <main class="directory-container">
            <section class="directory-hero card">
                <div class="hero-inner">
                    <h1>Retrouvez vos camarades</h1>
                    <p>Recherchez des étudiants par nom, filière ou promotion et élargissez votre réseau professionnel et amical.</p>

                    <form class="search-bar-wrapper" onsubmit="return false;">
                        <div class="search-input-group">
                            <i data-lucide="search"></i>
                            <input type="text" id="directorySearch" placeholder="Rechercher par nom...">
                        </div>
                        <button type="button" class="btn-publish">Rechercher</button>
                    </form>
                </div>
            </section>

            <section class="filters-area">
                <div class="filter-row">
                    <span class="filter-label">Filières:</span>
                    <div class="filter-chips">
                        <button class="chip active">Toutes</button>
                        <button class="chip">Ingénieur Logiciel</button>
                        <button class="chip">Data Science</button>
                        <button class="chip">Cybersécurité</button>
                        <button class="chip">Systèmes Embarqués</button>
                    </div>
                </div>
                <div class="filter-row">
                    <span class="filter-label">Promo:</span>
                    <div class="filter-chips">
                        <button class="chip active">Toutes</button>
                        <button class="chip">2024</button>
                        <button class="chip">2025</button>
                        <button class="chip">2026</button>
                    </div>
                </div>
            </section>

            <div class="section-header">
                <h2>Étudiants Suggérés</h2>
                <div class="view-switcher">
                    <span>Affichage:</span>
                    <button class="active"><i data-lucide="layout-grid"></i></button>
                    <button><i data-lucide="list"></i></button>
                </div>
            </div>

            <div class="user-grid">
                <article th:each="u : ${users}" class="user-card card">
                    <div class="user-card-top">
                        <div class="avatar-container">
                            <img th:src="${u.profilePictureUrl != null ? u.profilePictureUrl : '/images/default-avatar.png'}"
                                 class="avatar-directory"
                                 alt="Avatar">
                            <span class="online-badge"></span>
                        </div>
                        <button class="btn-more-small"><i data-lucide="more-vertical"></i></button>
                    </div>

                    <div class="user-card-body">
                        <h3 th:text="${u.firstName} + ' ' + ${u.lastName}">Thomas Durant</h3>
                        <span class="user-promo-label" th:text="'Promo ' + ${u.username}">Promo 2025</span> <p class="user-major-label">Ingénieur Logiciel</p>
                    </div>

                    <div class="user-card-footer">
                        <button class="btn-friend-request" th:data-id="${u.id}" th:data-action="send">
                            <i data-lucide="user-plus"></i> Ajouter
                        </button>
                        <button class="btn-msg-small" th:data-id="${u.id}" 
                                th:if="${isConnect != null && u.id.toString() != isConnect.toString()}"
                                th:style="${isConnect != null && u.id.toString() == isConnect.toString()} ? 'display: none;' : ''">
                            <i data-lucide="message-square"></i>
                        </button>
                        <button class="user-view" th:data-id="${u.id}">
                            <i data-lucide="eye"></i>
                        </button>
                    </div>
                </article>
            </div>

        </main>

        <div id="customAlert" class="custom-alert-overlay">
            <div class="custom-alert-card">
                <div class="alert-icon" id="alertIcon">
                    <i data-lucide="info"></i>
                </div>
                <h3 id="alertTitle">Notification</h3>
                <p id="alertMessage">Ceci est un message.</p>
                <button class="btn-alert-confirm" onclick="closeCustomAlert()">D'accord</button>
            </div>
        </div>

        <div th:replace="~{fragments/footer :: footer-fragment}"></div>

        <script>lucide.createIcons();</script>
        <script th:src="@{/js/friendRequest.js}"></script>
        <script th:src="@{/js/directory.js}"></script>

    </body>
</html>